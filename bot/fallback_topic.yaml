kind: AdaptiveDialog
beginDialog:
  kind: OnUnknownIntent
  id: main
  actions:
    - kind: SetVariable
      id: setVariable_isFollowup
      variable: Topic.IsFollowup
      value: =false

    - kind: InvokeFlowAction
      id: invokeFlowAction_main
      input:
        binding:
          text: =System.User.Email
          text_1: =System.Conversation.Id
          text_2: =System.Activity.Text
          boolean: =Topic.IsFollowup

      output:
        binding:
          responsetext: Topic.Response
          isfollowupexpecterd: Topic.IsFollowupExpected

      # WARNING: This flow ID MUST match RELAY_FLOW_ID in scripts/configure_bot_topic.py.
      # SendMessage flow: f6144661-8f48-9528-f120-b1666abccea0
      flowId: f6144661-8f48-9528-f120-b1666abccea0

    - kind: SendActivity
      id: sendActivity_response
      activity: "{Topic.Response}"

    - kind: ConditionGroup
      id: conditionGroup_followup
      conditions:
        - id: conditionItem_checkFollowup
          condition: =Topic.IsFollowupExpected = PlainText("true")

      elseActions:
        - kind: EndDialog
          id: endDialog_done

    - kind: SetVariable
      id: setVariable_followupTrue
      variable: Topic.IsFollowup
      value: =true

    - kind: GotoAction
      id: gotoAction_loop
      actionId: invokeFlowAction_main

inputType: {}
outputType: {}
